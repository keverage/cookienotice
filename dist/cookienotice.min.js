!function(l){"use strict";l.CookieNotice=function(e,s){return l.extend(!0,this.settings={},l.CookieNotice.defaults,s),this.elements={body:l("body"),container:e},this.elements.siteLinks=this.settings.siteLinks(this.elements.body),this.config=this.elements.container.attr("data-config"),this.cookieName="cookienotice",this.prepareOptions()?this.init():this},l.CookieNotice.defaults={siteLinks:function(e){return e.find('a[target!="_blank"]')},classes:{prefix:"cookienotice",notice:"notice notice--cookie",noticeOpen:"is-{prefix}-notice-open",modal:"modal modal--cookie",modalOpen:"is-{prefix}-modal-open",btnAgree:"{prefix}-agree",btnDisagree:"{prefix}-disagree",btnCustomize:"{prefix}-customize",active:"is-active",inactive:"is-inactive"},reload:!1,summary:767,cookieDuration:390,afterWrapNotice:void 0,afterWrapModal:void 0,afterEventsHandler:void 0,onChangeState:void 0},l.CookieNotice.services={},l.CookieNotice.prototype={prepareOptions:function(){return!!navigator.cookieEnabled&&(this.replacePrefixClass(),this.elements.container.length?void 0===this.config||""===this.config?(this.setLog('Attribute "data-config" not found in the container element.',"error"),!1):(this.config=JSON.parse(this.config),!0):(this.setLog("Container element not found.","error"),!1))},init:function(){return this.wrapNotice(),this.loadStates()||(this.setState("all","undefined"),this.notice("show")),this.wrapModal(),this.eventsHandler(),this},destroy:function(){return this.elements.container.remove(),this.elements.body.removeClass(this.settings.classes.noticeOpen).removeClass(this.settings.classes.modalOpen),this},wrapNotice:function(){var e,s,i=[];return this.elements.noticeWrapper=l("<div>",{class:this.settings.classes.notice}),void 0!==this.config.notice.description&&""!==this.config.notice.description&&(this.elements.noticeDescription=l("<p>",{class:this.settings.classes.prefix+"-notice-description",html:this.config.notice.description}),this.elements.noticeDescription.appendTo(this.elements.noticeWrapper)),this.elements.noticeActionsWrapper=l("<div>",{class:this.settings.classes.prefix+"-notice-actions"}),void 0!==this.config.modal&&void 0!==this.config.notice.customize&&""!==this.config.notice.customize&&(s=l("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--secondary "+this.settings.classes.btnCustomize,html:l("<span>",{html:this.config.notice.customize})}).appendTo(this.elements.noticeActionsWrapper),e=this.elements.body.find("."+this.settings.classes.prefix+"-customize"),i.push(s.get(0)),e.length&&i.push(e.get(0)),this.elements.btnCustomize=l(i)),void 0!==this.config.notice.agree&&""!==this.config.notice.agree&&(this.elements.btnAgree=l("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--primary "+this.settings.classes.btnAgree,html:l("<span>",{html:this.config.notice.agree})}).appendTo(this.elements.noticeActionsWrapper)),void 0!==this.config.notice.disagree&&""!==this.config.notice.disagree&&(this.elements.btnDisagree=l("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--secondary "+this.settings.classes.btnDisagree,html:l("<span>",{html:this.config.notice.disagree})}).appendTo(this.elements.noticeActionsWrapper)),this.elements.noticeActionsWrapper.appendTo(this.elements.noticeWrapper),this.elements.noticeWrapper.appendTo(this.elements.container),void 0!==this.settings.afterWrapNotice&&this.settings.afterWrapNotice.call({cookieNotice:this,elements:this.elements}),this},notice:function(e){this.elements.body[("hide"===e?"remove":"add")+"Class"](this.settings.classes.noticeOpen)},wrapModal:function(){var i,e,t,n,a=this;return void 0!==a.config.modal&&(a.elements.modalWrapper=l("<div>",{class:a.settings.classes.modal}),a.elements.modalHeader=l("<div>",{class:a.settings.classes.prefix+"-modal-header"}),void 0!==a.config.modal.label&&""!==a.config.modal.label&&l("<"+(a.config.modal.labelTag||"p")+">",{class:a.settings.classes.prefix+"-modal-label",html:a.config.modal.label}).appendTo(a.elements.modalHeader),void 0!==a.config.modal.description&&""!==a.config.modal.description&&l("<div>",{class:a.settings.classes.prefix+"-modal-description",html:a.config.modal.description}).appendTo(a.elements.modalHeader),void 0!==a.config.modal.close&&""!==a.config.modal.close&&(a.elements.modalClose=l("<button>",{class:a.settings.classes.prefix+"-modal-close",html:l("<span>",{html:a.config.modal.close})}).appendTo(a.elements.modalHeader)),a.elements.modalHeader.appendTo(a.elements.modalWrapper),void 0!==a.config.services&&(i={},l.each(this.config.services,function(e,s){"all"!==e&&(void 0===i[s.group]&&(i[s.group]=[]),i[s.group].push(e))}),a.elements.servicesWrapper=l("<div>",{class:a.settings.classes.prefix+"-services"}),-1!==(t=a.config.modal.labelTag||"p").indexOf("h")&&(e=parseInt(t.substring(1)),t="h"+ ++e),void 0!==a.config.services.all&&(a.elements.serviceAllWrapper=l("<div>",{class:a.settings.classes.prefix+"-service "+a.settings.classes.prefix+"-service--all","data-service":"all"}),l("<"+t+">",{class:a.settings.classes.prefix+"-service-all-label",html:a.config.services.all.label}).appendTo(a.elements.serviceAllWrapper),a.wrapServiceActions("all").appendTo(a.elements.serviceAllWrapper),a.elements.serviceAllWrapper.appendTo(a.elements.servicesWrapper)),n=l("<ul>"),l.each(i,function(e,s){var c,i=l("<li>",{class:a.settings.classes.prefix+"-group "+a.settings.classes.prefix+"-group--"+e}).appendTo(n);void 0!==a.config.groups[e].label&&""!==a.config.groups[e].label&&l("<"+t+">",{class:a.settings.classes.prefix+"-group--label",html:a.config.groups[e].label}).appendTo(i),void 0!==a.config.groups[e].description&&""!==a.config.groups[e].description&&l("<p>",{class:a.settings.classes.prefix+"-group--description",html:a.config.groups[e].description}).appendTo(i),s.length&&(c=l("<ul>"),l.each(s,function(e,s){var i=l("<li>",{class:a.settings.classes.prefix+"-service "+a.settings.classes.prefix+"-service--"+s,"data-service":s}),t=l("<div>",{class:a.settings.classes.prefix+"-service-label-wrapper"}),n={class:a.settings.classes.prefix+"-service-label",html:a.config.services[s].label},o=void 0!==a.config.services[s].url&&""!==a.config.services[s].url?(n.href=a.config.services[s].url,l("<a>",n)):l("<span>",n);o.appendTo(t),void 0!==a.config.services[s].description&&""!==a.config.services[s].description&&l("<p>",{class:a.settings.classes.prefix+"-service-description",html:a.config.services[s].description}).appendTo(t),t.appendTo(i),a.wrapServiceActions(s).appendTo(i),i.appendTo(c)}),c.appendTo(i))}),n.appendTo(a.elements.servicesWrapper),a.elements.servicesWrapper.appendTo(a.elements.modalWrapper)),a.elements.modalWrapper.appendTo(a.elements.container),a.elements.modalOverlay=l("<div>",{class:a.settings.classes.prefix+"-modal-overlay"}).appendTo(a.elements.container),void 0!==a.settings.afterWrapModal&&a.settings.afterWrapModal.call({cookieNotice:a,elements:a.elements})),a},wrapServiceActions:function(e){var i,t,s,n,o=this,c=o.getState(e),a=l("<div>",{class:o.settings.classes.prefix+"-service-actions"});return void 0!==o.config.services.all.agree&&""!==o.config.services.all.agree&&void 0!==o.config.services.all.disagree&&""!==o.config.services.all.disagree&&("all"===e&&(i=0,t=!1,l.each(l.CookieNotice.services,function(e,s){!0===s&&i++,"undefined"===s&&(t=!0)}),s=i===Object.keys(l.CookieNotice.services).length,c=t||0<i&&!s?"undefined":s),n=l("<span>",{class:o.settings.classes.prefix+"-service-action "+("undefined"===c?"":c?o.settings.classes.active:o.settings.classes.inactive)}),l("<span>",{class:o.settings.classes.prefix+"-service-action-input",html:l("<input>",{type:"checkbox",class:o.settings.classes.prefix+"-service-action-input--checkbox",id:o.settings.classes.prefix+"-service-action--"+e,name:e,value:c,checked:!0===c})}).appendTo(n),l("<label>",{for:o.settings.classes.prefix+"-service-action--"+e,class:o.settings.classes.prefix+"-service-action-label",html:"undefined"===c?o.config.services.all.customize:o.config.services.all[c?"agree":"disagree"],"aria-hidden":!0}).appendTo(n),n.appendTo(a)),a},modal:function(e){var s=this;s.elements.body[("hide"===e?"remove":"add")+"Class"](s.settings.classes.modalOpen),"show"===e&&setTimeout(function(){s.elements.modalWrapper.focus()},100)},eventsHandler:function(){var e,a=this;return!1!==a.settings.summary&&a.elements.noticeDescription.length&&void 0!==a.config.notice.summary&&""!==a.config.notice.summary&&l(window).width()<=a.settings.summary&&(a.elements.noticeDescription.html(a.config.notice.summary),a.elements.noticeDescription.on("click",function(e){l(e.target).is("a")||a.elements.noticeDescription.html()===a.config.notice.description||a.elements.noticeDescription.html(a.config.notice.description)})),void 0!==a.elements.btnAgree&&a.elements.btnAgree.length&&a.elements.btnAgree.one("click.cookienotice.btnAgree",function(){a.agree(),a.notice("hide"),a.settings.reload?a.reload():a.elements.serviceAction.length&&a.elements.serviceAction.each(function(e,s){"agree"===(s=l(s)).attr("data-action")&&s.addClass(a.settings.classes.active)})}),void 0!==a.elements.btnDisagree&&a.elements.btnDisagree.length&&a.elements.btnDisagree.one("click.cookienotice.btnDisagree",function(){a.disagree(),a.notice("hide"),a.settings.reload?a.reload():a.elements.serviceAction.length&&a.elements.serviceAction.each(function(e,s){"disagree"===(s=l(s)).attr("data-action")&&s.addClass(a.settings.classes.active)})}),void 0!==a.elements.btnCustomize&&a.elements.btnCustomize.length&&a.elements.btnCustomize.on("click.cookienotice.btnCustomize",function(e){e.preventDefault(),a.modal("show"),a.getCookie(a.cookieName)||a.notice("hide")}),void 0!==a.config.modal&&(e=function(e){("click"===e.type||"keydown"===e.type&&27===e.keyCode)&&(a.modal("hide"),a.getCookie(a.cookieName)||a.notice("show"),a.reload())},a.elements.modalClose.length&&a.elements.modalClose.on("click.cookienotice.modalClose",e),a.elements.modalOverlay.length&&a.elements.modalOverlay.on("click.cookienotice.modalOverlay",e),l(document).on("keydown.cookienotice.modalEscape",e),a.elements.serviceAction=a.elements.servicesWrapper.find("."+a.settings.classes.prefix+"-service-action"),a.elements.serviceAction.on("click.cookienotice.serviceAction",function(e){var s,i=l(e.currentTarget),t=i.find("input"),n=t.prop("checked"),o=i.find("label"),c=i.closest("."+a.settings.classes.prefix+"-service").attr("data-service");void 0!==c&&(i[(n?"remove":"add")+"Class"](a.settings.classes.active),i[(n?"add":"remove")+"Class"](a.settings.classes.inactive),t.prop("checked",!n),o.html(a.config.services.all[n?"disagree":"agree"]),"all"===c?a.elements.serviceAction.each(function(e,s){(s=l(s))[(n?"remove":"add")+"Class"](a.settings.classes.active),s[(n?"add":"remove")+"Class"](a.settings.classes.inactive),s.find("input").prop("checked",!n),s.find("label").html(a.config.services.all[n?"disagree":"agree"])}):((s=a.elements.serviceAllWrapper.find("."+a.settings.classes.prefix+"-service-action")).removeClass(a.settings.classes.active),s.removeClass(a.settings.classes.inactive),s.find("input").prop("checked",!1),s.find("label").html(a.config.services.all.customize)),a.setState(c,!n))})),a.elements.siteLinks.not(a.elements.container.find("a")).not("."+a.settings.classes.btnCustomize).one("click.cookienotice.siteLinks",function(){a.agree(),a.notice("hide")}),void 0!==a.settings.afterEventsHandler&&a.settings.afterEventsHandler.call({cookieNotice:a,elements:a.elements}),a},agree:function(e){return e=e||"all",this.setState(e,!0)},disagree:function(e){return e=e||"all",this.setState(e,!1)},setState:function(e,s){return"all"===e&&void 0!==this.config.services?l.each(this.config.services,function(e){"all"!==e&&(l.CookieNotice.services[e]=s)}):l.CookieNotice.services[e]=s,"undefined"!==s&&(this.setCookie(this.cookieName,JSON.stringify(l.CookieNotice.services),this.settings.cookieDuration),void 0!==this.settings.onChangeState&&this.settings.onChangeState.call({cookieNotice:this,services:l.CookieNotice.services,service:e,state:s})),this},loadStates:function(){var e=this.getCookie(this.cookieName);return!!e&&(e=JSON.parse(e),l.each(e,function(e,s){l.CookieNotice.services[e]=s}),e)},getState:function(e){return void 0!==l.CookieNotice.services[e]?l.CookieNotice.services[e]:"undefined"},isAllowed:function(e){return!0===this.getState(e)},hasConsent:function(){return!!this.getCookie(this.cookieName)},reload:function(){this.settings.reload&&window.location.reload()},getCookie:function(e){return new RegExp("(?:; )?"+e+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):null},setCookie:function(e,s,i,t){var n=new Date,o=new Date;t=t||"/",o.setTime(n.getTime()+24*i*60*60*1e3),document.cookie=e+"="+s+";expires="+o.toGMTString()+";path="+t+";"},removeCookie:function(e,s){return this.setCookie(e,"",-1,s)},setLog:function(e,s){s=s||"log",console[s]("CookieNotice: "+e)},replacePrefixClass:function(){var i=this;return l.each(i.settings.classes,function(e,s){"string"==typeof s&&(i.settings.classes[e]=s.replace(/{prefix}/,i.settings.classes.prefix))}),i}},l.fn.cookieNotice=function(e){return new l.CookieNotice(l(this),e)}}(jQuery);