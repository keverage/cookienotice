!function(p){"use strict";p.CookieNotice=function(e,s){return p.extend(!0,this.settings={},p.CookieNotice.defaults,s),this.elements={body:p("body"),container:e},this.elements.siteLinks=this.settings.siteLinks(this.elements.body),this.config=this.elements.container.attr("data-config"),this.cookieName="cookienotice",this.prepareOptions()?this.init():this},p.CookieNotice.defaults={siteLinks:function(e){return e.find('a[target!="_blank"]')},classes:{prefix:"cookienotice",notice:"notice notice--cookie",noticeOpen:"is-{prefix}-notice-open",modal:"modal modal--cookie",modalOpen:"is-{prefix}-modal-open",btnAgree:"{prefix}-agree",btnDisagree:"{prefix}-disagree",btnCustomize:"{prefix}-customize",active:"is-active",inactive:"is-inactive"},reload:!1,summary:767,cookieDuration:390,tabindexStart:0,afterWrapNotice:void 0,afterWrapModal:void 0,afterEventsHandler:void 0,onChangeState:void 0},p.CookieNotice.services={},p.CookieNotice.prototype={prepareOptions:function(){return!!navigator.cookieEnabled&&(this.replacePrefixClass(),this.elements.container.length?void 0===this.config||""===this.config?(this.setLog('Attribute "data-config" not found in the container element.',"error"),!1):(this.config=JSON.parse(this.config),!0):(this.setLog("Container element not found.","error"),!1))},init:function(){return this.wrapNotice(),this.loadStates()||(this.setState("all","undefined"),this.notice("show")),this.wrapModal(),this.eventsHandler(),this},destroy:function(){return this.elements.container.remove(),this.elements.body.removeClass(this.settings.classes.noticeOpen).removeClass(this.settings.classes.modalOpen),this},wrapNotice:function(){var e,s,t=[];return this.elements.noticeWrapper=p("<div>",{class:this.settings.classes.notice}),void 0!==this.config.notice.description&&""!==this.config.notice.description&&(this.elements.noticeDescription=p("<p>",{class:this.settings.classes.prefix+"-notice-description",html:this.config.notice.description}),this.elements.noticeDescription.appendTo(this.elements.noticeWrapper)),this.elements.noticeActionsWrapper=p("<div>",{class:this.settings.classes.prefix+"-notice-actions"}),void 0!==this.config.modal&&void 0!==this.config.notice.customize&&""!==this.config.notice.customize&&(s=p("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--secondary "+this.settings.classes.btnCustomize,html:p("<span>",{html:this.config.notice.customize})}).appendTo(this.elements.noticeActionsWrapper),e=this.elements.body.find("."+this.settings.classes.prefix+"-customize"),t.push(s.get(0)),e.length&&t.push(e.get(0)),this.elements.btnCustomize=p(t)),void 0!==this.config.notice.agree&&""!==this.config.notice.agree&&(this.elements.btnAgree=p("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--primary "+this.settings.classes.btnAgree,html:p("<span>",{html:this.config.notice.agree})}).appendTo(this.elements.noticeActionsWrapper)),void 0!==this.config.notice.disagree&&""!==this.config.notice.disagree&&(this.elements.btnDisagree=p("<button>",{class:this.settings.classes.prefix+"-btn "+this.settings.classes.prefix+"-btn--secondary "+this.settings.classes.btnDisagree,html:p("<span>",{html:this.config.notice.disagree})}).appendTo(this.elements.noticeActionsWrapper)),this.elements.noticeActionsWrapper.appendTo(this.elements.noticeWrapper),this.elements.noticeWrapper.appendTo(this.elements.container),void 0!==this.settings.afterWrapNotice&&this.settings.afterWrapNotice.call({cookieNotice:this,elements:this.elements}),this},notice:function(e){this.elements.body[("hide"===e?"remove":"add")+"Class"](this.settings.classes.noticeOpen)},wrapModal:function(){var t,e,i,n,l,r,d=this;return void 0!==d.config.modal&&(d.elements.modalWrapper=p("<div>",{class:d.settings.classes.modal,role:"dialog",tabindex:"-1"}),d.elements.modalHeader=p("<div>",{class:d.settings.classes.prefix+"-modal-header"}),void 0!==d.config.modal.label&&""!==d.config.modal.label&&(p("<"+(d.config.modal.labelTag||"p")+">",{class:d.settings.classes.prefix+"-modal-label",html:d.config.modal.label}).appendTo(d.elements.modalHeader),d.elements.modalWrapper.attr("aria-label",d.config.modal.label)),void 0!==d.config.modal.description&&""!==d.config.modal.description&&p("<div>",{class:d.settings.classes.prefix+"-modal-description",html:d.config.modal.description}).appendTo(d.elements.modalHeader),void 0!==d.config.modal.close&&""!==d.config.modal.close&&(d.elements.modalClose=p("<button>",{class:d.settings.classes.prefix+"-modal-close",html:p("<span>",{html:d.config.modal.close})}).appendTo(d.elements.modalHeader)),d.elements.modalHeader.appendTo(d.elements.modalWrapper),void 0!==d.config.services&&(t={},p.each(this.config.services,function(e,s){"all"!==e&&(void 0===t[s.group]&&(t[s.group]=[]),t[s.group].push(e))}),d.elements.servicesWrapper=p("<div>",{class:d.settings.classes.prefix+"-services"}),-1!==(i=d.config.modal.labelTag||"p").indexOf("h")&&(e=parseInt(i.substring(1)),i="h"+ ++e),void 0!==d.config.services.all&&(d.elements.serviceAllWrapper=p("<div>",{class:d.settings.classes.prefix+"-service "+d.settings.classes.prefix+"-service--all","data-service":"all"}),p("<"+i+">",{class:d.settings.classes.prefix+"-service-all-label",html:d.config.services.all.label}).appendTo(d.elements.serviceAllWrapper),d.wrapServiceActions("all").appendTo(d.elements.serviceAllWrapper),d.elements.serviceAllWrapper.appendTo(d.elements.servicesWrapper)),n=p("<ul>"),l=0,r=Object.keys(t).length,p.each(t,function(e,c){var a,s=p("<li>",{class:d.settings.classes.prefix+"-group "+d.settings.classes.prefix+"-group--"+e}).appendTo(n);void 0!==d.config.groups[e].label&&""!==d.config.groups[e].label&&p("<"+i+">",{class:d.settings.classes.prefix+"-group--label",html:d.config.groups[e].label}).appendTo(s),void 0!==d.config.groups[e].description&&""!==d.config.groups[e].description&&p("<p>",{class:d.settings.classes.prefix+"-group--description",html:d.config.groups[e].description}).appendTo(s),c.length&&(a=p("<ul>"),p.each(c,function(e,s){var t=p("<li>",{class:d.settings.classes.prefix+"-service "+d.settings.classes.prefix+"-service--"+s,"data-service":s}),i=p("<div>",{class:d.settings.classes.prefix+"-service-label-wrapper"}),n={class:d.settings.classes.prefix+"-service-label",html:d.config.services[s].label},o=void 0!==d.config.services[s].url&&""!==d.config.services[s].url?(n.href=d.config.services[s].url,n.tabindex=d.settings.tabindexStart,p("<a>",n)):p("<span>",n);o.appendTo(i),void 0!==d.config.services[s].description&&""!==d.config.services[s].description&&p("<p>",{class:d.settings.classes.prefix+"-service-description",html:d.config.services[s].description}).appendTo(i),l===r-1&&e===c.length-1&&t.addClass("is-last"),i.appendTo(t),d.wrapServiceActions(s).appendTo(t),t.appendTo(a)}),a.appendTo(s)),l++}),n.appendTo(d.elements.servicesWrapper),d.elements.servicesWrapper.appendTo(d.elements.modalWrapper)),d.elements.modalWrapper.appendTo(d.elements.container),d.elements.modalOverlay=p("<div>",{class:d.settings.classes.prefix+"-modal-overlay"}).appendTo(d.elements.container),void 0!==d.settings.afterWrapModal&&d.settings.afterWrapModal.call({cookieNotice:d,elements:d.elements})),d},wrapServiceActions:function(e){var t,i,s,n,o=this,c=o.getState(e),a=p("<div>",{class:o.settings.classes.prefix+"-service-actions"});return void 0!==o.config.services.all.agree&&""!==o.config.services.all.agree&&void 0!==o.config.services.all.disagree&&""!==o.config.services.all.disagree&&("all"===e&&(t=0,i=!1,p.each(p.CookieNotice.services,function(e,s){!0===s&&t++,"undefined"===s&&(i=!0)}),s=t===Object.keys(p.CookieNotice.services).length,c=i||0<t&&!s?"undefined":s),n=p("<span>",{class:o.settings.classes.prefix+"-service-action "+("undefined"===c?"":c?o.settings.classes.active:o.settings.classes.inactive)}),p("<span>",{class:o.settings.classes.prefix+"-service-action-input",tabindex:o.settings.tabindexStart,html:p("<input>",{type:"checkbox",class:o.settings.classes.prefix+"-service-action-input--checkbox",id:o.settings.classes.prefix+"-service-action--"+e,name:e,value:c,checked:!0===c})}).appendTo(n),p("<label>",{for:o.settings.classes.prefix+"-service-action--"+e,class:o.settings.classes.prefix+"-service-action-label",html:"undefined"===c?o.config.services.all.customize:o.config.services.all[c?"agree":"disagree"],"aria-hidden":!0}).appendTo(n),n.appendTo(a)),a},modal:function(e){var s=this;s.elements.body[("hide"===e?"remove":"add")+"Class"](s.settings.classes.modalOpen),"show"===e&&setTimeout(function(){s.elements.modalWrapper.focus()},100),"hide"===e&&void 0!==s.elements.openBtn&&s.elements.openBtn.length&&setTimeout(function(){s.elements.openBtn=void 0},200)},eventsHandler:function(){var e,l=this;return!1!==l.settings.summary&&l.elements.noticeDescription.length&&void 0!==l.config.notice.summary&&""!==l.config.notice.summary&&p(window).width()<=l.settings.summary&&(l.elements.noticeDescription.html(l.config.notice.summary),l.elements.noticeDescription.on("click",function(e){p(e.target).is("a")||l.elements.noticeDescription.html()===l.config.notice.description||l.elements.noticeDescription.html(l.config.notice.description)})),void 0!==l.elements.btnAgree&&l.elements.btnAgree.length&&l.elements.btnAgree.one("click.cookienotice.btnAgree",function(){l.agree(),l.notice("hide"),l.settings.reload?l.reload():l.elements.serviceAction.length&&l.elements.serviceAction.each(function(e,s){"agree"===(s=p(s)).attr("data-action")&&s.addClass(l.settings.classes.active)})}),void 0!==l.elements.btnDisagree&&l.elements.btnDisagree.length&&l.elements.btnDisagree.one("click.cookienotice.btnDisagree",function(){l.disagree(),l.notice("hide"),l.settings.reload?l.reload():l.elements.serviceAction.length&&l.elements.serviceAction.each(function(e,s){"disagree"===(s=p(s)).attr("data-action")&&s.addClass(l.settings.classes.active)})}),void 0!==l.elements.btnCustomize&&l.elements.btnCustomize.length&&l.elements.btnCustomize.on("click.cookienotice.btnCustomize keyup.cookienotice.btnCustomize",function(e){"click"!==e.type&&("keyup"!==e.type||"Enter"!==e.key&&" "!==e.key)||(e.preventDefault(),l.modal("show"),l.elements.openBtn=p(e.currentTarget),l.getCookie(l.cookieName)||l.notice("hide"))}),void 0!==l.config.modal&&(e=function(e){("click"===e.type||"keydown"===e.type&&"Escape"===e.key)&&(!l.settings.reload&&void 0!==l.elements.openBtn&&l.elements.openBtn.length&&(e.preventDefault(),setTimeout(function(){l.elements.openBtn.focus()},100)),l.modal("hide"),l.getCookie(l.cookieName)||l.notice("show"),l.reload())},l.elements.modalClose.length&&l.elements.modalClose.on({"click.cookienotice.modalClose":e,"keydown.cookienotice.modalClose":function(e){"Tab"===e.key&&e.shiftKey&&(e.preventDefault(),l.elements.servicesWrapper.find(".is-last ."+l.settings.classes.prefix+"-service-action-input").focus())}}),l.elements.modalOverlay.length&&l.elements.modalOverlay.on("click.cookienotice.modalOverlay",e),p(document).on("keydown.cookienotice.modalEscape",e),l.elements.serviceAction=l.elements.servicesWrapper.find("."+l.settings.classes.prefix+"-service-action"),l.elements.serviceAction.on("click.cookienotice.serviceAction keydown.cookienotice.serviceAction",function(e){var s,t,i,n,o,c=p(e.currentTarget),a=c.closest("."+l.settings.classes.prefix+"-service");" "===e.key&&e.preventDefault(),"click"!==e.type&&("keydown"!==e.type||"Enter"!==e.key&&" "!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key)||(s=c.find("input"),t=s.prop("checked"),i=c.find("label"),void 0!==(n=a.attr("data-service"))&&(c[(t?"remove":"add")+"Class"](l.settings.classes.active),c[(t?"add":"remove")+"Class"](l.settings.classes.inactive),s.prop("checked",!t),i.html(l.config.services.all[t?"disagree":"agree"]),"all"===n?l.elements.serviceAction.each(function(e,s){(s=p(s))[(t?"remove":"add")+"Class"](l.settings.classes.active),s[(t?"add":"remove")+"Class"](l.settings.classes.inactive),s.find("input").prop("checked",!t),s.find("label").html(l.config.services.all[t?"disagree":"agree"])}):((o=l.elements.serviceAllWrapper.find("."+l.settings.classes.prefix+"-service-action")).removeClass(l.settings.classes.active),o.removeClass(l.settings.classes.inactive),o.find("input").prop("checked",!1),o.find("label").html(l.config.services.all.customize)),l.setState(n,!t))),"keydown"===e.type&&"Tab"===e.key&&!e.shiftKey&&a.hasClass("is-last")&&(e.preventDefault(),l.elements.modalClose.focus())})),l.elements.siteLinks.not(l.elements.container.find("a")).not("."+l.settings.classes.btnCustomize).one("click.cookienotice.siteLinks",function(){l.agree(),l.notice("hide")}),void 0!==l.settings.afterEventsHandler&&l.settings.afterEventsHandler.call({cookieNotice:l,elements:l.elements}),l},agree:function(e){return e=e||"all",this.setState(e,!0)},disagree:function(e){return e=e||"all",this.setState(e,!1)},setState:function(e,s){return"all"===e&&void 0!==this.config.services?p.each(this.config.services,function(e){"all"!==e&&(p.CookieNotice.services[e]=s)}):p.CookieNotice.services[e]=s,"undefined"!==s&&(this.setCookie(this.cookieName,JSON.stringify(p.CookieNotice.services),this.settings.cookieDuration),void 0!==this.settings.onChangeState&&this.settings.onChangeState.call({cookieNotice:this,services:p.CookieNotice.services,service:e,state:s})),this},loadStates:function(){var e=this.getCookie(this.cookieName);return!!e&&(e=JSON.parse(e),p.each(e,function(e,s){p.CookieNotice.services[e]=s}),e)},getState:function(e){return void 0!==p.CookieNotice.services[e]?p.CookieNotice.services[e]:"undefined"},isAllowed:function(e){return!0===this.getState(e)},hasConsent:function(){return!!this.getCookie(this.cookieName)},reload:function(){this.settings.reload&&window.location.reload()},getCookie:function(e){return new RegExp("(?:; )?"+e+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):null},setCookie:function(e,s,t,i){var n=new Date,o=new Date;i=i||"/",o.setTime(n.getTime()+24*t*60*60*1e3),document.cookie=e+"="+s+";expires="+o.toGMTString()+";path="+i+";"},removeCookie:function(e,s){return this.setCookie(e,"",-1,s)},setLog:function(e,s){s=s||"log",console[s]("CookieNotice: "+e)},replacePrefixClass:function(){var t=this;return p.each(t.settings.classes,function(e,s){"string"==typeof s&&(t.settings.classes[e]=s.replace(/{prefix}/,t.settings.classes.prefix))}),t}},p.fn.cookieNotice=function(e){return new p.CookieNotice(p(this),e)}}(jQuery);